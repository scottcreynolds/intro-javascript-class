<!doctype html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>reveal.js</title>

  <link rel="stylesheet" href="css/reveal.css">
  <link rel="stylesheet" href="css/theme/black.css">

  <!-- Theme used for syntax highlighting of code -->
  <link rel="stylesheet" href="lib/css/zenburn.css">

  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
    document.getElementsByTagName('head')[0].appendChild(link);
  </script>
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <!--    intro-->
      <section class="center">
        <h2>Introduction to JavaScript</h2>
        <h4>Day 3: Server Side JavaScript &amp; Bots</h4>
      </section>
      <section>
        <h2>Any Questions?</h2>
      </section>
      <section>
        <h2>Day Two Quiz</h2>
        <ul>
          <li class="fragment">What is AJAX?</li>
          <li class="fragment">What is JSON?</li>
          <li class="fragment">What is the difference between JSON and a js Object?</li>
          <li class="fragment">What jQuery functions do we use to make AJAX requests?</li>
          <li class="fragment">What routing pattern uses resource-based URIs for server operations?</li>
        </ul>
      </section>
      <section>
        <h2>Quiz Cont'd</h2>
        <ul>
          <li class="fragment">What HTTP verb is used to read data from the server?</li>
          <li class="fragment">What HTTP verb is used to write data to the server?</li>
          <li class="fragment">What are the different ways to authenticate to an API?</li>
          <li class="fragment">Which authentication method is most common for application-level operations?</li>
          <li class="fragment">Which authentication method is most common for user-level operations?</li>
        </ul>
      </section>
      <section>
        <h2>Quiz, Cont'd</h2>
        <pre class="fragment"><code>let planet = {name: "Jupiter"}</code></pre>
        <ul>
          <li class="fragment">What is this code doing?</li>
          <li class="fragment">How would we add Jupiter's moons to this object</li>
          <li class="fragment">What would we need to do to send this object as an API response?</li>
          <li class="fragment">What code would we need to write to find out how many moons this planet has?</li>
        </ul>
      </section>
      <section>
        <h2>Today's Agenda</h2>
        <ul>
          <li class="fragment">Server-side JavaScript with Node</li>
          <li class="fragment">Routing and Responding to HTTP requests</li>
          <li class="fragment">Webhooks</li>
          <li class="fragment">Spark API</li>
          <li class="fragment">Spark Bots</li>
        </ul>
      </section>
      <section>
        <h2>Postman API Review</h2>
        <ul>
          <li class="fragment">Turn off cache-control and postman headers</li>
          <li class="fragment">GETs</li>
          <li class="fragment">Auth</li>
          <li class="fragment">POSTs</li>
        </ul>
        <aside class="notes">Generate Code, Read docs</aside>
      </section>
      <section>
        <h2>New Tools</h2>
        <ul>
          <li>ngrok</li>
          <li>Node.js</li>
          <li>NPM</li>
        </ul>
      </section>
      <section>
        <h2>What is Node.js?</h2>
        <p>Node is an "asynchronous event-driven JavaScript runtime".</p>
        <small>
        <ul>
          <li class="fragment">Runtime - a place that executes code. Chrome Inspector, REPL.it, Node.js</li>
          <li class="fragment">Event-driven - Implemented as an event loop, it just waits for instructions to execute. </li>
          <li class="fragment">Asynchronous - Executes code in a way that doesn't block the client or force it to wait.</li>
          <li class="fragment">Built with HTTP in mind. Networking is a first-class citizen. Streaming and latency are core design concerns.</li>
          <li class="fragment">Full ES6 compliance!</li>
        </ul>
        </small>
        <aside class="notes">This is a simplification of course</aside>
      </section>
      <section>
        <h2>Node Ecosystem</h2>
        <ul>
          <li class="fragment">Node Core - The Runtime</li>
          <li class="fragment">Modules/Packages - External Libraries</li>
          <li class="fragment">NPM - Node Package Manager (think sublime package manager)</li>
          <li class="fragment">Task Runners (gulp/grunt) - deploy and utility</li>
        </ul>
        <aside class="notes">other package managers like yarn. ton of tools. can be daunting. sticking with basics.</aside>
      </section>
      <section>
        <h2>Hello Node</h2>
        <p>First thing's first. Let's launch Node in REPL mode and play with it. Drop into a terminal/console and type <code>node</code></p>
        <pre class="fragment"><code>//do some js!
let i = 0;
i++;
function square(x) {
  return x*x
}
square(15)

.exit //leave the REPL</code></pre>
      </section>
      <section>
        <h2>Running Scripts with Node</h2>
        <pre class="fragment"><code>//my_script.js
function hello() {
  console.log('Hello World')
}
hello()</code></pre>
       <pre class="fragment"><code>//terminal
node my_script.js</code></pre>
      <p class="fragment">Just a script runner. Nothing scary.</p>
      </section>
      <section>
        <h2>Node Debugger</h2>
        <small>
          <ul>
            <li><code>node debug program.js</code></li>
            <li><code>n</code> -> next instruction</li>
            <li><code>repl</code> -> enter repl to check values/change values</li>
            <li><code>s/o</code> -> step in/out</li>
            <li><code>c</code> -> continue until breakpoint</li>
            <li><code>sb(5)</code> -> set breakpoint at line 5</li>
            <li>responds to <code>debugger</code> in source</li>
            <li><code>help</code> -> you guessed it</li>
          </ul>
        </small>
        <aside class="notes">node debug node_debug.js. show repl to change val of a. show restart. show rerunning the code.</aside>
      </section>
      <section>
        <h2>Creating a Web Server</h2>
        <p>Enough talk. Node is a server-side js runtime, so let's create a server.</p>
        <pre class="fragment"><code>//server.js
var http = require("http");

http.createServer(function(request, response) {
  response.writeHead(200, {"Content-Type": "text/plain"});
  response.write("Hello World");
  response.end();
}).listen(8888);</code></pre>
<pre class="fragment"><code>node server.js</code></pre>
      <aside class="notes">run the server, then walk through code line by line. console.log some output, examine the request object, esp request.headers and request.url</aside>
      </section>
      <section>
        <h2>Routing</h2>
        <p>Routing in a web application is a system of mapping a request to a URL with an action that handles that request and provides a response.</p>
        <p>A web application will have multiple endpoints, so we need a way to capture the requested endpoint and make a decision.</p>
        <aside class="notes">routing_server.js look at url. how we make decisions? Extract a couple route handlers.</aside>
      </section>

      <section>
        <h4>API Considerations</h4>
        <ul>
          <li class="fragment">RESTful Routes and HTTP Verbs</li>
          <li class="fragment">Resource Management (data, files, other APIs)</li>
          <li class="fragment">Code Organization</li>
          <li class="fragment">Productivity</li>
          <li class="fragment">Performance</li>
        </ul>
        <small><p class="fragment">All of this is a lot when you're doing it by hand. Gotta be a better way!</p></small>
        <aside class="notes">And a bot IS an API</aside>
      </section>
      <section>
        <h2>NPM</h2>
        <p>NPM - the Node Package Manager, is used to install and manage dependencies and libraries in your projects.</p>
        <ul>
          <li>npmjs.com - find packages</li>
          <li>Create NPM-aware projects with <code>npm init</code></li>
          <li>install packages with <code>npm install package</code></li>
        </ul>
        <aside class="notes">explore npmjs for a hot minute</aside>
      </section>
      <section>
        <h2>Express</h2>
        <p><small>Flexible, minimal Node.js web application framework</small></p>
        <pre class="fragment"><code>npm init
npm install express --save
touch index.js</code></pre>
        <pre class="fragment"><code>const express = require('express')
const app = express()

app.get('/', function(req, res) {
  res.send('Hello Express!')
})

app.listen(8888, function() {
  console.log("Hello, Seattle, I'm listening")
})
// console
node index.js
</code></pre>
        <aside class="notes">--save auto adds to dependencies section so npm install works. show that it handles missing routes. add a route. talk about verbs.</aside>
      </section>
      <section>
        <h2>Express Middleware</h2>
        <p><em>Middleware</em> is a function or functions inserted into Express to act on the request/response objects and provide extra functionality.</p>
      </section>
      <section>
        <h2>Body Parser Middleware</h2>
        <pre class="fragment"><code>app.post('/', function(req,res) {
  console.log(req.body);
  res.end("SUCCESS")
})</code></pre>
        <pre class="fragment"><code>const bodyParser = require('body-parser')

app.use(bodyParser.json());
</code></pre>
      <pre class="fragment"><code>npm i body-parser</code></pre>
      <aside class="notes">use postman to test before/after</aside>
      </section>
      <section>
        <h4>Design an API with Postman</h4>
        <p>Postman is great for testing APIs, but we can also use it to help us drive the design of our own server code!</p>
        <aside class="notes">use postman, show headers/body, params/query, build requests</aside>
      </section>

      <section>
        <h2>Consuming APIs in Node</h2>
        <ul>
          <li>Not that different from what we've already done!</li>
          <li>Be mindful of the Request/Response lifecycle.</li>
        </ul>
        <aside class="notes">show request, replicate a web page, walk through the response.end</aside>
      </section>
      <section>
        <h2>Interesting Node Modules</h2>
        <ul>
          <li class="fragment">Nodemailer</li>
          <li class="fragment">Cheerio.js</li>
          <li class="fragment">CSV</li>
          <li class="fragment">google "node module <em>task</em>"</li>
        </ul>
      </section>
      <section>
        <h2>Node API Lab</h2>
        <p>Create an Express server application with a route of GET /api. In your route handler, consume an API (eg, the Star Wars API) and output the data from the third-party API to the browser.</p>
      </section>
      <section>
        <h2>Webhooks</h2>
        <p>Webhooks are endpoints that allow one system to notify another of something that happened. You can think of it like an "event api" or a "web callback".</p>
        <p>Semantic differences aside, webhooks exist to receive notifications of events, e.g. a message was posted in a Spark channel.</p>
      </section>
      <section>
        <h2>Chat Bots</h2>
        <p>A chat bot is essentially an API that responds to events in a chat program. It consists of two parts:</p>
        <ul>
          <li class="fragment">Webhook Endpoint to receive event notifications.</li>
          <li class="fragment">Server Code to process event/respond</li>
        </ul>
        <aside class="notes">Webhook must be public!</aside>
      </section>
      <section>
        <h2>Exploring the Cisco Spark API</h2>
        <ul>
          <li class="fragment">Create and interact with rooms, search for people, post and retrieve messages.</li>
          <li class="fragment">Use bot to interact with <em>other</em> APIs to provide rich mashup experiences.</li>
          <li class="fragment">https://developer.ciscospark.com/index.html</li>
        </ul>
        <aside class="notes">Do the Curl then explore the docs</aside>
      </section>
      <section>
        <h2>Hosting Bots</h2>
        <p>ngrok is a tool that lets us tunnel a public request to our private machine. Great for development and testing.</p>
        <p>For a real bot, you'd host it somewhere publicly accessible.</p>
        <p>Note: If you restart ngrok you have to update the endpoint url. not persistent.</p>
      </section>
      <section>
        <h2>Creating a Simple Chat Bot</h2>
        <ul>
          <li class="fragment">Register Bot (https://developer.ciscospark.com/add-bot.html)</li>
          <li class="fragment">Add Bot to Room</li>
          <li class="fragment"><code>./ngrok http 8888</code></li>
          <li class="fragment">Get Room Id, Set Up Webhook</li>
          <li class="fragment">Update Bot Template</li>
          <li class="fragment">Run it!</li>
          <li class="fragment">When updating, stop the bot, not ngrok.</li>
        </ul>
        <aside class="notes">add the flint.showHelp(), look at other things flint and bot can do. point out being careful with implode.</aside>
      </section>
      <section>
        <h2>Bot Account Limitations</h2>
        <ul>
          <li>Bots can only "hear" messages that mention them.</li>
          <li>Bots are limited in some API functions (can't get room messages)</li>
        </ul>
        <p class="fragment">We can use a separate API token, and Sparky, to get around this.</p>
      </section>
      <section>
        <h2>Beyond Just Bot Code</h2>
        <p>You can combine your bot with other API code (consuming and serving) to really make interesting things happen.</p>
        <aside class="notes">Full-on integrations out of scope but let's take a little look.</aside>
      </section>
      <section>
        <h2>Project</h2>
        <p>Upgrade your Chat Bot to respond to more than one command, and to interact with a third-party API. You can use APIs from exercises we've already done, like Star Wars or Github, or explore something new!</p>
      </section>
      <section>
        <h2>Questions?</h2>
      </section>
      <!-- bonus -->
      <section>
        <h2>Other Bot Platforms</h2>
        <aside class="notes">botkit/cisco</aside>
      </section>
    </div>
  </div>

  <script src="lib/js/head.min.js"></script>
  <script src="js/reveal.js"></script>

  <script>
    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
      history: true,
      center: false,

      // More info https://github.com/hakimel/reveal.js#dependencies
      dependencies: [{
          src: 'plugin/markdown/marked.js'
        },
        {
          src: 'plugin/markdown/markdown.js'
        },
        {
          src: 'plugin/notes/notes.js',
          async: true
        },
        {
          src: 'plugin/highlight/highlight.js',
          async: true,
          callback: function() {
            hljs.initHighlightingOnLoad();
          }
        }
      ]
    });
  </script>
</body>
</html>
